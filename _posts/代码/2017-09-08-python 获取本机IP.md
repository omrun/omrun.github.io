---
layout: post
title: python 获取本机IP
date: 2017-09-08 22:08:07 +0759
category: 代码
tags: [python]
---

### 获取本机IP
- 从外网获取

```python
import urllib.request  #引用urllib.request模块

def getip():  #从网页获取ip
  page = urllib.request.urlopen('http://ip.3322.net', timeout=10)
  data = page.read()
  data = data.decode('utf8')
  if (data.count('.')!=3):
    page = urllib.request.urlopen('http://ip.cip.cc', timeout=10)
    data = page.read()
    data = data.decode('utf8')

  def getmidstr(content, startStr, endStr):  #取中间字符
    try:
      startIndex = content.index(startStr)
      if startIndex >= 0 :

        startIndex += len(startStr)
        endIndex = content.find(endStr,startIndex)
        st=content[startIndex:endIndex]
      else:
        st=""
      return st
    except:
      return ""
  return (getmidstr(data, "", "\n"))

print(getip())  #输出ip
```

- 从本地获取
 
```python
import socket
def get_local_ip():
  s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
  try:
    s.connect(('baidu.com', 80))
    ip = s.getsockname()[0]
    s.close()
  except:
    ip = 'N/A'
  return ip
  
print(get_local_ip())  #输出ip
```

